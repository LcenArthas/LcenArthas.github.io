
[{"content":"","date":"Saturday, 2024-06-15","externalUrl":null,"permalink":"/tags/github/","section":"Tags","summary":"","title":"Github","type":"tags"},{"content":"","date":"Saturday, 2024-06-15","externalUrl":null,"permalink":"/tags/github-action/","section":"Tags","summary":"","title":"Github Action","type":"tags"},{"content":" 1ã€ä»€ä¹ˆæ˜¯ Github Action ? # GitHub Actions æ˜¯ GitHub æä¾›çš„ä¸€é¡¹ æŒç»­é›†æˆå’ŒæŒç»­äº¤ä»˜ï¼ˆCI/CDï¼‰æœåŠ¡ï¼Œå…è®¸å¼€å‘è€…åœ¨ä»£ç åº“ä¸Šè‡ªåŠ¨åŒ–å„ç§ä»»åŠ¡ã€‚\nç®€å•æ¥è¯´ï¼Œä½ å¯ä»¥æŠŠ GitHub Actions æƒ³è±¡æˆåœ¨ä½ çš„ GitHub ä»£ç ä»“åº“é‡Œçš„ä¸€ä¸ªæœºå™¨äººï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®ä½ ç»™å®ƒè®¾å®šçš„è§„åˆ™ï¼Œè‡ªåŠ¨å®Œæˆä¸€ç³»åˆ—ä»»åŠ¡ï¼ˆWorkflowï¼‰ï¼Œä¸»è¦ç›®çš„å°±æ˜¯æœåŠ¡äºè¿™ä¸ªé¡¹ç›®ï¼ˆä»£ç ä»“åº“ï¼‰ã€‚\n2ã€åŸºæœ¬æ¦‚å¿µ # Workflowï¼ˆå·¥ä½œæµç¨‹ï¼‰ï¼šå®šä¹‰äº†ä¸€ç³»åˆ—è¦è‡ªåŠ¨æ‰§è¡Œçš„è¿‡ç¨‹ã€‚è¯¦æƒ…å¯ä»¥è§ ç¬¬ä¸‰èŠ‚ã€‚\nEventï¼ˆäº‹ä»¶ï¼‰ï¼šè§¦å‘ Workflow å·¥ä½œæµçš„åŠ¨ä½œï¼Œä¾‹å¦‚ pushã€pull requestã€release ç­‰ã€‚è¯¦æƒ…å¯è§ å®˜æ–¹æ–‡æ¡£ã€‚\nJobï¼ˆä»»åŠ¡ï¼‰ï¼šä¸€ä¸ª Workflow ç”±ä¸€ä¸ªæˆ–å¤šä¸ª Jobs æ„æˆï¼Œä¸€æ¬¡ Workflow çš„è¿è¡Œï¼Œå¯ä»¥å®Œæˆå¤šä¸ª Jobsã€‚\nStepï¼ˆæ­¥éª¤ï¼‰ï¼šæ¯ä¸ª Jobs ç”±å¤šä¸ª Step æ„æˆï¼Œä¸€æ­¥æ­¥å®Œæˆã€‚\nActionï¼ˆåŠ¨ä½œï¼‰ï¼šæ¯ä¸ª Step å¯ä»¥ä¾æ¬¡æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªå‘½ä»¤ï¼ˆActionï¼‰ã€‚\nevent(è§¦å‘) -\u0026gt; workflow -\u0026gt; job -\u0026gt; step -\u0026gt; action\n3ã€ä¾‹å­ï¼šGithub Page é™æ€åšå®¢è‡ªåŠ¨å‘å¸ƒ # ä½¿ç”¨ Github Action æ„å»ºåšå®¢è‡ªåŠ¨å‘å¸ƒæµç¨‹ã€‚\nä¹‹å‰æ‰‹åŠ¨å‘å¸ƒé™æ€çš„åšå®¢æ–‡ä»¶ï¼Œ éœ€è¦åˆ‡æ¢åˆ° public/ ç›®å½•è¿›è¡Œ pushï¼Œ æ›´æ–° Github page ç•Œé¢\næ˜¯å¦å¯ä»¥åœ¨ pushåˆ° åšå®¢åŸæ–‡ä»¶ä»“åº“çš„æ—¶å€™ï¼Œè‡ªåŠ¨æ›´æ–° Github Pageï¼ˆBlogï¼‰ç•Œé¢å‘¢ï¼Ÿ\n1. é…ç½® workflow æ–‡ä»¶ # GitHub Actions çš„é…ç½®æ–‡ä»¶å«åš workflow æ–‡ä»¶ï¼Œå­˜æ”¾åœ¨ä»£ç ä»“åº“çš„ .github/workflows ç›®å½•ã€‚\nworkflow æ–‡ä»¶é‡‡ç”¨ YAML æ ¼å¼ï¼Œæ–‡ä»¶åå¯ä»¥ä»»æ„å–ï¼Œä½†æ˜¯åç¼€åç»Ÿä¸€ä¸º .ymlï¼Œæ¯”å¦‚ blog.ymlã€‚\nä¸€ä¸ªåº“å¯ä»¥æœ‰å¤šä¸ª workflow æ–‡ä»¶ã€‚GitHub åªè¦å‘ç° .github/workflows ç›®å½•é‡Œé¢æœ‰ .ymlæ–‡ä»¶ï¼Œå°±ä¼šè‡ªåŠ¨è¿è¡Œè¯¥æ–‡ä»¶ã€‚\nè‡ªåŠ¨å‘å¸ƒç¤ºä¾‹é…ç½®å¦‚ä¸‹ï¼š\nname: Automatic Blog Publishing on: push: schedule: # Runs everyday at 8:00 AM - cron: \u0026#34;0 0 * * *\u0026#34; jobs: publish: name: auto publish blog runs-on: ubuntu-latest steps: - name: Checkout uses: actions/checkout@v4 with: submodules: true fetch-depth: 0 - name: Setup Hugo uses: peaceiris/actions-hugo@v2 with: hugo-version: \u0026#34;latest\u0026#34; - name: Build Web run: hugo - name: Deploy Web uses: peaceiris/actions-gh-pages@v3 with: PERSONAL_TOKEN: ${{ secrets.AUTO_PUBLISH_BLOG_TOKEN }} EXTERNAL_REPOSITORY: LcenArthas/LcenArthas.github.io PUBLISH_BRANCH: main PUBLISH_DIR: ./public commit_message: ${{ github.event.head_commit.message }} ä¸‹é¢é’ˆå¯¹ä¸Šé¢çš„ workflow é…ç½®æ–‡ä»¶ï¼Œè§£é‡Šå…¶ä¸­ç”¨åˆ°çš„å­—æ®µã€‚\nworkflow æ–‡ä»¶å­—æ®µéå¸¸å¤šï¼Œè¯¦è§ å®˜æ–¹æ–‡æ¡£\n1. name å­—æ®µ # æ˜¯ workflow çš„åç§°ã€‚å¦‚æœçœç•¥è¯¥å­—æ®µï¼Œé»˜è®¤ä¸ºå½“å‰ workflow çš„æ–‡ä»¶åã€‚\nname: Automatic Blog Publishing 2. on å­—æ®µ # æŒ‡å®šè§¦å‘ workflow çš„æ¡ä»¶ï¼Œé€šå¸¸æ˜¯æŸäº›äº‹ä»¶ã€‚ä¸‹é¢ä»£ç æŒ‡å®šï¼Œpush äº‹ä»¶è§¦å‘ workflowã€‚\nå®Œæ•´çš„äº‹ä»¶åˆ—è¡¨ï¼Œè¯·æŸ¥çœ‹ å®˜æ–¹æ–‡æ¡£ã€‚\non.schedule å­—æ®µ\né™¤äº†ä»£ç åº“äº‹ä»¶ï¼ŒGitHub Actions ä¹Ÿæ”¯æŒå®šæ—¶è¿è¡Œã€‚æ³¨æ„ï¼Œæ—¶é—´æ˜¯ä½¿ç”¨ POSIX cron è¯­æ³•å°†å·¥ä½œæµè®¡åˆ’ä¸ºåœ¨æŒ‡å®šçš„ UTC æ—¶é—´è¿è¡Œã€‚\non: push: schedule: # Runs everyday at 8:00 AM (UTC 0:00 AM) - cron: \u0026#34;0 0 * * *\u0026#34; 3. job å­—æ®µ # workflow æ–‡ä»¶çš„ä¸»ä½“æ˜¯jobså­—æ®µï¼Œè¡¨ç¤ºè¦æ‰§è¡Œçš„ä¸€é¡¹æˆ–å¤šé¡¹ä»»åŠ¡ã€‚éœ€è¦ç»™å‡ºæ¯ä¸€é¡¹ä»»åŠ¡çš„ job_idï¼Œå…·ä½“åç§°è‡ªå®šä¹‰ï¼Œ ä¾‹å¦‚æˆ‘ä»¬è®¾ç½®äº†ä¸€ä¸ª publish ä»»åŠ¡ã€‚\njobs.\u0026lt;job_id\u0026gt;.name å­—æ®µ\næ˜¯ä»»åŠ¡çš„è¯´æ˜ï¼Œå¯ä»¥ä»»æ„å†™ã€‚\njobs.\u0026lt;job_id\u0026gt;.runs-on å­—æ®µ\næ˜¯æŒ‡å®šè¿è¡Œæ‰€éœ€è¦çš„è™šæ‹Ÿæœºç¯å¢ƒã€‚å®ƒæ˜¯å¿…å¡«å­—æ®µã€‚ç›®å‰å¯ç”¨çš„è™šæ‹Ÿæœºè§ å®˜æ–¹æ–‡æ¡£\njobs: publish: name: auto publish blog runs-on: ubuntu-latest 4. jobs.\u0026lt;job_id\u0026gt;.steps å­—æ®µ # æ˜¯æŒ‡ä½œä¸šåŒ…å«ä¸€ç³»åˆ—ä»»åŠ¡ï¼Œç§°ä¸º stepsã€‚ æ­¥éª¤å¯ä»¥è¿è¡Œå‘½ä»¤ã€è¿è¡Œè®¾ç½®ä»»åŠ¡ï¼Œæˆ–è€…è¿è¡Œæ‚¨çš„ä»“åº“ã€å…¬å…±ä»“åº“ä¸­çš„æ“ä½œæˆ– Docker æ³¨å†Œè¡¨ä¸­å‘å¸ƒçš„æ“ä½œã€‚\næ¯ä¸ª Job å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæ­¥éª¤ã€‚\njobs.\u0026lt;job_id\u0026gt;.steps.nameå­—æ®µ\næ˜¯æŒ‡æ­¥éª¤åç§°ã€‚\njobs.\u0026lt;job_id\u0026gt;.steps.uses å­—æ®µ\næ˜¯æŒ‡å¯ä»¥ä½¿ç”¨åœ¨ä¸å·¥ä½œæµã€ å®˜æ–¹actionsã€ å®˜æ–¹actionså¸‚åœºæˆ–è€… å·²å‘å¸ƒçš„ Docker å®¹å™¨æ˜ åƒç›¸åŒçš„å­˜å‚¨åº“ä¸­å®šä¹‰çš„æ“ä½œã€‚\njobs.\u0026lt;job_id\u0026gt;.steps.with å­—æ®µ\næ˜¯æŒ‡æŸäº›æ“ä½œéœ€è¦å¿…é¡»ä½¿ç”¨ with å…³é”®å­—è®¾ç½®çš„è¾“å…¥ã€‚å¾—çœ‹å…·ä½“å¼•ç”¨çš„å·¥ä½œæµéœ€è¦çš„å‚æ•°ã€‚\nä¸‹é¢é€æ­¥åˆ†ææ¯ä¸ªæ­¥éª¤çš„ä½œç”¨\nsteps: - name: Checkout uses: actions/checkout@v4 with: submodules: true fetch-depth: 0 ä¸Šé¢æ˜¯å¼•ç”¨äº† GitHub Action Checkout @v4ç‰ˆæœ¬ è¿™ä¸ªå·¥ä½œæµã€‚\nå®ƒé€šå¸¸æ˜¯è®¸å¤šå·¥ä½œæµçš„ç¬¬ä¸€æ­¥ï¼Œç”¨äºè·å–æºç ï¼ˆå°†ä»“åº“çš„å†…å®¹æ£€å‡ºåˆ°è¿è¡Œå·¥ä½œæµçš„è™šæ‹Ÿæœºä¸Šï¼Œä½¿å¾—åç»­æ­¥éª¤å¯ä»¥è®¿é—®å’Œæ“ä½œä»£ç ã€‚ï¼‰\nsubmodulesï¼štrueï¼Œä¼šæ£€å‡ºå­æ¨¡å—ï¼Œå³æˆ‘ä»¬çš„ä¸»é¢˜æ¨¡å—ã€‚ fetch-depth: 0ï¼ŒæŒ‡å®šæ£€å‡ºçš„æäº¤å†å²è®°å½•æ·±åº¦ã€‚é»˜è®¤æ˜¯ 1ï¼Œå³åªæ£€å‡ºæœ€æ–°çš„æäº¤ã€‚è®¾ç½®ä¸º 0 è¡¨ç¤ºå®Œæ•´æ£€å‡ºæ‰€æœ‰å†å²è®°å½•ã€‚ ä¾‹å¦‚ï¼š\n- name: Setup Hugo uses: peaceiris/actions-hugo@v3 with: hugo-version: \u0026#34;latest\u0026#34; ä¸Šé¢æ˜¯å¼•ç”¨äº† GitHub Action Hugo setup @v3ç‰ˆæœ¬ è¿™ä¸ªå·¥ä½œæµã€‚\nä½œç”¨æ˜¯å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„ Hugo é™æ€ç«™ç‚¹ç”Ÿæˆå™¨ã€‚\nä¾‹å¦‚ï¼š\n- name: Build Web run: hugo è¿™ä¸€æ­¥éª¤æ‰§è¡Œäº† hugo å‘½ä»¤ï¼Œç”¨äºè¿è¡Œ Hugo å‘½ä»¤æ¥æ„å»ºç½‘ç«™ã€‚\nä¾‹å¦‚ï¼š\n- name: Deploy Web uses: peaceiris/actions-gh-pages@v4 with: PERSONAL_TOKEN: ${{ secrets.AUTO_PUBLISH_BLOG_TOKEN }} EXTERNAL_REPOSITORY: LcenArthas/LcenArthas.github.io PUBLISH_BRANCH: main PUBLISH_DIR: ./public commit_message: ${{ github.event.head_commit.message }} ä¸Šé¢æ˜¯å¼•ç”¨äº† GitHub Action GitHub Pages action @v4ç‰ˆæœ¬ è¿™ä¸ªå·¥ä½œæµã€‚\nä½œç”¨æ˜¯ç”¨äºå°†ç”Ÿæˆçš„é™æ€ç½‘ç«™éƒ¨ç½²åˆ° GitHub Pageã€‚\nEXTERNAL_REPOSITORY: LcenArthas/LcenArthas.github.ioï¼ŒæŒ‡å®šè¦å°†å†…å®¹éƒ¨ç½²åˆ°çš„å¤–éƒ¨ä»“åº“ã€‚\nPERSONAL_TOKEN: ${{ secrets.AUTO_PUBLISH_BLOG_TOKEN }}ï¼Œç”¨äºè®¤è¯çš„ GitHub ä¸ªäººè®¿é—®ä»¤ç‰Œï¼Œé€šå¸¸é€šè¿‡ GitHub Secrets ç®¡ç†ã€‚\ncommit_message: ${{ github.event.head_commit.message }}ï¼Œä½¿ç”¨è§¦å‘å·¥ä½œæµçš„æäº¤ä¿¡æ¯ä½œä¸ºéƒ¨ç½²çš„æäº¤ä¿¡æ¯ã€‚è¿™æ ·å¯ä»¥ä¿ç•™æäº¤å†å²çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚\nPUBLISH_BRANCH: main, æŒ‡å®šè¦æ¨é€åˆ°çš„ç›®æ ‡åˆ†æ”¯ï¼Œå¦‚æœä¸æƒ³æ–°å»ºåˆ†æ”¯ï¼ŒæŒ‡å®š Github Page çš„ä¸»åˆ†æ”¯ï¼ˆmain/masterï¼‰\n5. å¦‚ä½•åˆ›å»º secrets.AUTO_PUBLISH_BLOG_TOKEN # è¦åœ¨ GitHub è´¦æˆ·ä¸‹ Setting - Developer setting - Personal access tokens ä¸‹åˆ›å»ºä¸€ä¸ª Tokenã€‚æƒé™éœ€è¦å¼€å¯ repo ä¸ workflowã€‚ é…ç½®åå¤åˆ¶ç”Ÿæˆçš„ Tokenï¼ˆæ³¨ï¼šåªä¼šå‡ºç°ä¸€æ¬¡, æ¨èå¦å­˜ä¸€ä¸ªåœ°æ–¹ï¼‰ Make sure to copy your personal access token now. You wonâ€™t be able to see it again! ç„¶ååœ¨æˆ‘ä»¬åšå®¢æºä»“åº“çš„ Settings - Secrets - Actions ä¸­æ·»åŠ  Tokenï¼Œ ç²˜è´´åœ¨ Secret ä¸­ï¼ŒName éšä¾¿èµ·ä¸€ä¸ªï¼Œä½†æ˜¯æ³¨æ„è¦å’Œ PERSONAL_TOKEN: ${{ secrets.AUTO_PUBLISH_BLOG_TOKEN }} åé¢çš„AUTO_PUBLISH_BLOG_TOKEN ä¸€è‡´ï¼Œè¿™æ · GitHub Action å°±å¯ä»¥è·å–åˆ° Token äº†ã€‚\nå®Œæˆä¸Šè¿°é…ç½®åï¼Œæ¨é€ä»£ç è‡³ä»“åº“ï¼Œå³å¯è§¦å‘ GitHub Actionï¼Œè‡ªåŠ¨ç”Ÿæˆåšå®¢é¡µé¢å¹¶æ¨é€è‡³ GitHub Pages ä»“åº“ã€‚ 2. æ¨é€æœ¬åœ°åšå®¢ä»£ç è‡³ä»“åº“ # å®Œæˆä¸Šè¿°é…ç½®åï¼Œæ¨é€ä»£ç è‡³ä»“åº“ï¼Œå³å¯è§¦å‘ GitHub Actionï¼Œè‡ªåŠ¨ç”Ÿæˆåšå®¢é¡µé¢å¹¶æ¨é€è‡³ GitHub Pages ä»“åº“ã€‚\nå¯ä»¥åœ¨ä»“åº“çš„ Actions - All workflows ä¸­çœ‹åˆ°è¿è¡ŒçŠ¶æ€å’Œlogsã€‚\nå‚è€ƒèµ„æ–™ # [1]. é˜®ä¸€å³°GitHub Actions å…¥é—¨æ•™ç¨‹\n[2]. GitHub Actions å®˜æ–¹æ–‡æ¡£\n[3]. Hugo + GitHub Actionï¼Œæ­å»ºä½ çš„åšå®¢è‡ªåŠ¨å‘å¸ƒç³»ç»Ÿ\n","date":"Saturday, 2024-06-15","externalUrl":null,"permalink":"/blog/github_action/","section":"å½’æ¡£","summary":"","title":"Github Action + åŸºäº Github Page Blog è‡ªåŠ¨å‘å¸ƒ","type":"blog"},{"content":"","date":"Saturday, 2024-06-15","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"","date":"Saturday, 2024-06-15","externalUrl":null,"permalink":"/blog/","section":"å½’æ¡£","summary":"","title":"å½’æ¡£","type":"blog"},{"content":" ","date":"Saturday, 2024-06-15","externalUrl":null,"permalink":"/","section":"æ¬¢è¿æ¥åˆ° Blowfish! ğŸ‰","summary":"","title":"æ¬¢è¿æ¥åˆ° Blowfish! ğŸ‰","type":"page"},{"content":" About Me # ç¨‹åºå‘˜ï¼Œé˜…è¯»è€…ï¼Œäººé—´è§‚å¯Ÿè€…ï¼Œå¿«ä¹NPC About Site # æœ¬ç«™ç”Ÿæ—¥ï¼š2024-06-02 ","date":"Sunday, 2024-06-02","externalUrl":null,"permalink":"/about/","section":"æ¬¢è¿æ¥åˆ° Blowfish! ğŸ‰","summary":"","title":"About","type":"page"},{"content":"","date":"Monday, 0001-01-01","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","date":"Monday, 0001-01-01","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","date":"Monday, 0001-01-01","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"},{"content":"","date":"Monday, 0001-01-01","externalUrl":null,"permalink":"/movienote/","section":"ç”µå½±","summary":"","title":"ç”µå½±","type":"movienote"},{"content":"","date":"Monday, 0001-01-01","externalUrl":null,"permalink":"/booknote/","section":"è¯»ä¹¦","summary":"","title":"è¯»ä¹¦","type":"booknote"}]